<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complain Formatter V8</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(to bottom, #f1f5f9, #e2e8f0);
      margin: 0;
      padding: 20px 10px;
      color: #1e293b;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      overflow: hidden;
    }
    .header {
      background: #059669;
      color: white;
      padding: 24px 20px;
      text-align: center;
    }
    .header h1 { margin: 0; font-size: 1.6rem; }
    .header p { margin: 8px 0 0; font-size: 1.05rem; opacity: 0.95; }
    .content { padding: 24px 20px; }
    textarea {
      width: 95%;
      min-height: 100px;
      padding: 16px;
      font-size: 15px;
      line-height: 1.5;
      border: 2px solid #cbd5e0;
      border-radius: 12px;
      font-family: 'Courier New', monospace;
      background: #f8fafc;
      resize: vertical;
      margin-bottom: 16px;
    }
    textarea:focus {
      border-color: #1e40af;
      box-shadow: 0 0 0 4px rgba(30,64,175,0.15);
      outline: none;
    }
    button {
      background: #059669;
      color: white;
      border: none;
      padding: 16px;
      font-size: 1.15rem;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      width: 100%;
      transition: background 0.2s;
    }
    button:hover { background: #1e3a8a; }
    .output-grid {
      margin-top: 32px;
      display: grid;
      gap: 28px;
    }
    .output-card {
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      overflow: hidden;
      background: white;
    }
    .output-title {
      background: #eff6ff;
      padding: 12px 16px;
      font-weight: 600;
      font-size: 1.1rem;
      border-bottom: 1px solid #e2e8f0;
    }
    .output-content {
      padding: 16px;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 14.5px;
      line-height: 1.6;
      background: #fafafa;
      min-height: 160px;
    }
    .copy-button {
      background: #059669;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      margin: 12px 16px;
      float: right;
    }
    .copy-button:hover { background: #047857; }
    #toast {
      position: fixed;
      bottom: 32px;
      right: 32px;
      background: #059669;
      color: white;
      padding: 14px 28px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.4s ease;
      z-index: 1000;
      font-weight: 600;
    }
    #toast.visible { opacity: 1; transform: translateY(0); }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>Complain Formatter</h1>
    <!-- <p>এখন ID-র পরের extra number (যেমন 3774586477) অটো বাদ যাবে</p> -->
  </div>

  <div class="content">
    <textarea id="input" placeholder="ডেটা পেস্ট করো..."></textarea>
    
    <button onclick="parseAndFormat()">Format </button>

    <div class="output-grid">
      <div class="output-card">
        <div class="output-title">অনু তে লাল বাতি জ্বলে</div>
        <div class="output-content" id="result1">...</div>
        <button class="copy-button" id="copyBtn1" style="display:none;" onclick="copyResult(1)">Copy</button>
      </div>

      <div class="output-card">
        <div class="output-title">নো নেটওয়ার্ক সার্ভিস</div>
        <div class="output-content" id="result2">...</div>
        <button class="copy-button" id="copyBtn2" style="display:none;" onclick="copyResult(2)">Copy</button>
      </div>
    </div>
  </div>
</div>

<div id="toast">Copied to clipboard!</div>

<script>

function parseAndFormat() {
  const text = document.getElementById('input').value.trim();
  if (!text) return;

  const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
  let output1 = '';
  let output2 = '';

  lines.forEach(line => {
    let id = (line.match(/NCDV\d+/) || [])[0] || '';
    if (!id) return;

    // নাম: ID এর পর থেকে 'District #' এর আগ পর্যন্ত (District # এর আগে যা আছে তাই নাম)
    let name = '';
    const idPos = line.indexOf(id);
    const districtPos = line.indexOf('District #', idPos);
    if (districtPos > idPos) {
      name = line.substring(idPos + id.length, districtPos).trim();
    }

    // অ্যাড্রেস: শুধু 'Area #' এর পরের অংশ থেকে প্রথম 880... পর্যন্ত
    let address = '';
    const areaPos = line.indexOf('Area #');
    if (areaPos > -1) {
      const addrStart = areaPos + 'Area #'.length;
      const firstPhonePos = line.indexOf('880', addrStart);
      if (firstPhonePos > addrStart) {
        address = line.substring(addrStart, firstPhonePos).trim().replace(/,\s*$/, '');
      } else {
        // যদি ফোন না পাওয়া যায়, তারিখের আগ পর্যন্ত
        const datePos = line.search(/\d{1,2}\s+[A-Za-z]{3}\s+\d{4}/);
        address = line.substring(addrStart, datePos > -1 ? datePos : line.length).trim().replace(/,\s*$/, '');
      }
    }

    // ফোন: প্রথম 880xxxxxxxxxx
    const phones = line.match(/880\d{10}/g) || [];
    const phone = phones[0] || '';

    // তারিখ
    const dateMatch = line.match(/(\d{1,2}\s+[A-Za-z]{3}\s+\d{4})/);
    const date = dateMatch ? dateMatch[1] : '';

    if (name && address && phone) {
      const block = `Complain#\n${id}\n${name}\n${address},\n${phone}${date ? `\n${date}` : ''}\n\n`;
      output1 += block + 'অনু তে লাল বাতি জ্বলে\n\n';
      output2 += block + 'নো নেটওয়ার্ক সার্ভিস\n\n';
    }
  });

  document.getElementById('result1').textContent = output1.trim() || 'কোনো বৈধ ডেটা পার্স হয়নি';
  document.getElementById('result2').textContent = output2.trim() || 'কোনো বৈধ ডেটা পার্স হয়নি';

  const show = output1 || output2;
  document.getElementById('copyBtn1').style.display = show ? 'block' : 'none';
  document.getElementById('copyBtn2').style.display = show ? 'block' : 'none';
}

function copyResult(n) {
  const text = document.getElementById('result' + n).textContent;
  navigator.clipboard.writeText(text).then(() => {
    document.getElementById('toast').classList.add('visible');
    setTimeout(() => document.getElementById('toast').classList.remove('visible'), 2200);
  }).catch(() => alert('কপি করতে সমস্যা'));
}
</script>
</body>
</html>